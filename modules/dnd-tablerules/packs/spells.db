{"type":"spell","system":{"description":{"value":"<p>A flash of light streaks toward a creature of your choice within range. Make a ranged spell attack against the target. On a hit, the target takes 4d6 radiant damage, and the next attack roll made against this target before the end of your next turn has advantage, thanks to the mystical dim light glittering on the target until then.</p>\n<p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d6 for each slot level above 1st.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 248","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"round"},"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":120,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"wis","actionType":"rsak","attackBonus":"0","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["4d6[radiant]","radiant"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"evo","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"level","formula":"1d6"}},"name":"Guiding Bolt","flags":{"ddbimporter":{"id":138023,"definitionId":2133,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Cleric","level":1,"characterClassId":118182112,"spellLevel":1,"ability":"wis","mod":2,"dc":12,"cantripBoost":false,"overrideDC":false,"id":138023,"entityTypeId":435869154,"healingBoost":2,"usesSpellSlot":true},"originalName":"Guiding Bolt","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":248,"sourceType":1}],"tags":["Damage","Buff"],"version":"3.2.4","importId":"XpwygIbTgqS9zbhX"},"spell-class-filter-for-5e":{"parentClass":"cleric"},"midi-qol":{"fumbleThreshold":null,"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.jItLUReNSJ6NAwL3.Item.TrSQY9r3fAutcaUU"}},"img":"icons/magic/fire/projectile-fireball-smoke-large-blue.webp","effects":[{"label":"Guiding Bolt","icon":"icons/magic/fire/projectile-fireball-smoke-large-blue.webp","origin":"Actor.3IDJAqCn3WKSy8xf.Item.TrSQY9r3fAutcaUU","duration":{"rounds":1,"startTime":null,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"ID0l92YKhsroB0ok","changes":[],"tint":null,"transfer":false,"flags":{"effectmacro":{"onCreate":{"script":"let params =\n[{\n    filterType: \"glow\",\n    filterId: \"GuidingBolt\",\n    outerStrength: 4,\n    innerStrength: 0,\n    color: 0x5099DD,\n    quality: 0.5,\n    padding: 10,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0xfff24f, \n           val2:0xfffabc\n        }\n    }\n}];\n\nawait TokenMagic.addFilters(token, params);"},"onDelete":{"script":"await TokenMagic.deleteFilters(token, \"GuidingBolt\");"}},"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669694313372,"modifiedTime":1671041501812,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"4TWWkEh04XwJDdMz"}
{"type":"spell","system":{"description":{"value":"<p>Each object in a 20-foot cube within range is outlined in blue, green, or violet light (your choice). Any creature in the area when the spell is cast is also outlined in light if it fails a Dexterity saving throw. For the duration, objects and affected creatures shed dim light in a 10-foot radius.</p>\n<p>Any attack roll against an affected creature or object has advantage if the attacker can see it, and the affected creature or object can't benefit from being @Compendium[dnd5e.rules.w7eitkpD7QQTB6j0]{invisible}.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 239","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":20,"width":null,"units":"ft","type":"cube"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"dex","dc":null,"scaling":"spell"},"level":1,"school":"evo","components":{"value":"","vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"none","formula":""}},"name":"Faerie Fire","flags":{"ddbimporter":{"id":1337237,"definitionId":2091,"entityTypeId":420821570,"dndbeyond":{"class":"Ranger","lookup":"classFeature","lookupName":"Swarmkeeper Magic","lookupId":2991412,"level":3,"ability":"wis","mod":3,"dc":13,"overrideDC":false,"id":1337237,"entityTypeId":420821570,"healingBoost":0,"usesSpellSlot":true},"originalName":"Faerie Fire","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":239,"sourceType":1}],"tags":["Debuff"],"version":"3.2.7","importId":"zamgiLpNfuUC7XVv"},"midi-qol":{"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.LRVMkm47PS7mtTbc.Item.PR5GLiREEx7hGAS5"}},"img":"icons/magic/fire/projectile-meteor-salvo-strong-teal.webp","effects":[{"label":"Faerie Fire","icon":"icons/magic/fire/projectile-meteor-salvo-strong-teal.webp","origin":"Actor.LRVMkm47PS7mtTbc.Item.PR5GLiREEx7hGAS5","duration":{"seconds":60,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"zCaRxtVk0VGJIWNr","changes":[],"tint":null,"transfer":false,"flags":{"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false},"transferrable":{"self":true,"target":true}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"effectmacro":{"onCreate":{"script":"let params =\n[{\n    filterType: \"glow\",\n    filterId: \"Faerie Fire\",\n    outerStrength: 4,\n    innerStrength: 0,\n    color: 0x5099DD,\n    quality: 0.5,\n    padding: 10,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0x00FF00, \n           val2:0x006600\n        }\n    }\n}];\n\nawait TokenMagic.addUpdateFilters(token, params);"},"onDelete":{"script":"await TokenMagic.deleteFilters(token, \"Faerie Fire\");"}}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1670449337548,"modifiedTime":1671041496203,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"9zSosmFfHluIlPll"}
{"type":"spell","system":{"description":{"value":"<p>A frigid beam of blue-white light streaks toward a creature within range. Make a ranged spell attack against the target. On a hit, it takes 1d8 cold damage, and its speed is reduced by 10 feet until the start of your next turn.</p>\n<p>The spell's damage increases by 1d8 when you reach 5th level (2d8), 11th level (3d8), and 17th level (4d8).</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 271","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":"inst"},"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"rsak","attackBonus":"0","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["1d8[cold]","cold"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":0,"school":"evo","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"cantrip","formula":"1d8"}},"name":"Ray of Frost","flags":{"ddbimporter":{"id":138634,"definitionId":2226,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Wizard","level":1,"characterClassId":108474208,"spellLevel":0,"ability":"int","mod":3,"dc":13,"cantripBoost":false,"overrideDC":false,"id":138634,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":false},"originalName":"Ray of Frost","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":271,"sourceType":1}],"tags":["Damage"],"version":"3.2.4","importId":"EgKCIFc1BkVC5JrI"},"spell-class-filter-for-5e":{"parentClass":"wizard"},"midi-qol":{"fumbleThreshold":null,"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"offHandWeapon":false},"core":{"sourceId":"Actor.ZhhF2ZWDPIY2g3KI.Item.Aw0bAaInqHlR7iL6"}},"img":"icons/magic/light/beam-rays-blue-small.webp","effects":[{"label":"Ray of Frost","icon":"icons/magic/light/beam-rays-blue-small.webp","origin":"Actor.6jtmp2Joatnf8PuB.Item.Aw0bAaInqHlR7iL6","duration":{"rounds":1,"startTime":null,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"NUt8F9KvRFPPh7UR","changes":[{"key":"system.attributes.movement.walk","mode":2,"value":"-10","priority":20},{"key":"system.attributes.movement.burrow","mode":2,"value":"-10","priority":20},{"key":"system.attributes.movement.climb","mode":2,"value":"-10","priority":20},{"key":"system.attributes.movement.fly","mode":2,"value":"-10","priority":20},{"key":"system.attributes.movement.swim","mode":2,"value":"-10","priority":20}],"tint":null,"transfer":false,"flags":{"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669500366049,"modifiedTime":1671041504786,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"AJX3ggZgZlEKg246"}
{"type":"spell","system":{"description":{"value":"<p>Up to three creatures of your choice that you can see within range must make Charisma saving throws. Whenever a target that fails this saving throw makes an attack roll or a saving throw before the spell ends, the target must roll a d4 and subtract the number rolled from the attack roll or saving throw.</p>\n<p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 2nd level or higher, you can target one additional creature for each slot level above 1st.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 216","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":3,"width":null,"units":"","type":"creature"},"range":{"value":30,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"wis","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"cha","dc":null,"scaling":"wis"},"level":1,"school":"enc","components":{"value":"a drop of blood","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"a drop of blood","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"none","formula":""}},"name":"Bane","flags":{"ddbimporter":{"id":136081,"definitionId":2009,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Cleric","level":1,"characterClassId":118182112,"spellLevel":1,"ability":"wis","mod":2,"dc":12,"cantripBoost":false,"overrideDC":false,"id":136081,"entityTypeId":435869154,"healingBoost":2,"usesSpellSlot":true},"originalName":"Bane","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":216,"sourceType":1}],"tags":["Debuff"],"version":"3.2.4","importId":"XpwygIbTgqS9zbhX"},"spell-class-filter-for-5e":{"parentClass":"cleric"},"midi-qol":{"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.jItLUReNSJ6NAwL3.Item.yF1aBXH1BQyoF0rW"}},"img":"icons/magic/unholy/strike-beam-blood-red-purple.webp","effects":[{"label":"Bane","icon":"icons/magic/unholy/strike-beam-blood-red-purple.webp","origin":"Actor.3IDJAqCn3WKSy8xf.Item.yF1aBXH1BQyoF0rW","duration":{"seconds":60,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"ZM538EnHCYsXD3W4","changes":[{"key":"system.bonuses.All-Attacks","mode":2,"value":"-1d4","priority":20},{"key":"system.bonuses.abilities.save","mode":2,"value":"-1d4","priority":20}],"tint":null,"transfer":false,"flags":{"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669694313366,"modifiedTime":1671041490248,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"GfLc8kZzS5w1448a"}
{"type":"spell","system":{"description":{"value":"<p>You touch one willing creature. Once before the spell ends, the target can roll a d4 and add the number rolled to one ability check of its choice. It can roll the die before or after making the ability check. The spell then ends.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 248","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":10,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"1d4","save":{"ability":"","dc":null,"scaling":"spell"},"level":0,"school":"div","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"none","formula":""}},"name":"Guidance","flags":{"ddbimporter":{"id":2415266,"definitionId":2132,"entityTypeId":420821570,"dndbeyond":{"lookup":"feat","lookupName":"Strixhaven Initiate (Quandrix - Charisma)","lookupId":804983,"level":null,"ability":"cha","mod":3,"dc":13,"overrideDC":false,"id":2415266,"entityTypeId":420821570,"healingBoost":0,"usesSpellSlot":false},"originalName":"Guidance","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":248,"sourceType":1}],"tags":["Buff"],"version":"3.2.4","importId":"fbvS33ZV7suCX06g"},"midi-qol":{"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"offHandWeapon":false},"core":{"sourceId":"Actor.veOJg27EGlME2eld.Item.xKoc4njpm29ygQdm"}},"img":"icons/magic/control/buff-flight-wings-blue.webp","effects":[],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669692601341,"modifiedTime":1671041499366,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"Jc2RSASCKKbJe9WN"}
{"type":"spell","system":{"description":{"value":"<p>An @Compendium[dnd5e.rules.w7eitkpD7QQTB6j0]{invisible} barrier of magical force appears and protects you. Until the start of your next turn, you have a +5 bonus to AC, including against the triggering attack, and you take no damage from <strong>magic missile</strong>.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 275","activation":{"type":"reaction","cost":1,"condition":"which you take when you are hit by an attack or targeted by the magic missile spell"},"duration":{"value":1,"units":"round"},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"abj","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"name":"Shield (Water Theme)","flags":{"ddbimporter":{"id":138703,"definitionId":2247,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Wizard","level":3,"characterClassId":108474208,"spellLevel":1,"ability":"int","mod":3,"dc":13,"cantripBoost":false,"overrideDC":false,"id":138703,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Shield","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":275,"sourceType":1}],"tags":["Warding"],"version":"3.2.7","importId":"zviDp4XHAwjSNQBR"},"spell-class-filter-for-5e":{"parentClass":"wizard"},"midi-qol":{"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.6jtmp2Joatnf8PuB.Item.IMtL5XRHVBIy981T"}},"img":"icons/magic/defensive/shield-barrier-glowing-triangle-magenta.webp","effects":[{"label":"Shield (Water Theme)","icon":"icons/magic/defensive/shield-barrier-glowing-triangle-magenta.webp","origin":"Actor.6jtmp2Joatnf8PuB.Item.IMtL5XRHVBIy981T","duration":{"rounds":1,"startTime":null,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"f2BRdkNkOycdA71j","changes":[],"tint":null,"transfer":false,"flags":{"effectmacro":{"onCreate":{"script":"let params =\n[{\n    filterType: \"field\",\n    filterId: \"myWaterShield\",\n    shieldType: 9,\n    gridPadding: 1.2,\n    color: 0x20BBEE,\n    time: 0,\n    blend: 4,\n    intensity: 1,\n    lightAlpha: 0.7,\n    lightSize: 0.5,\n    scale: 0.6,\n    radius: 0.5,\n    chromatic: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\n\nawait TokenMagic.addUpdateFiltersOnSelected(params);"},"onDelete":{"script":"await TokenMagic.deleteFilters(token, \"myWaterShield\");"}},"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false},"transferrable":{"self":true,"target":true}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1670549196605,"modifiedTime":1671041509750,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"KYcAQfqI5QBoyfk1"}
{"type":"spell","system":{"description":{"value":"<p>You touch one object that is no larger than 10 feet in any dimension. Until the spell ends, the object sheds bright light in a 20-foot radius and dim light for an additional 20 feet. The light can be colored as you like. Completely covering the object with something opaque blocks the light. The spell ends if you cast it again or dismiss it as an action.</p>\n<p>If you target an object held or worn by a hostile creature, that creature must succeed on a Dexterity saving throw to avoid the spell.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 255","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"hour"},"target":{"value":1,"width":null,"units":"","type":"object"},"range":{"value":null,"long":null,"units":"touch"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"dex","dc":null,"scaling":"spell"},"level":0,"school":"evo","components":{"value":"a firefly or phosphorescent moss","vocal":true,"somatic":false,"material":true,"ritual":false,"concentration":false},"materials":{"value":"a firefly or phosphorescent moss","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"none","formula":""}},"name":"Light","flags":{"ddbimporter":{"id":138400,"definitionId":2166,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Cleric","level":10,"characterClassId":116804531,"spellLevel":0,"ability":"wis","mod":3,"dc":15,"cantripBoost":false,"overrideDC":false,"id":138400,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":false},"originalName":"Light","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":255,"sourceType":1}],"tags":["Creation","Utility"],"version":"3.2.4","importId":"HK5s4atPMmweQr7v"},"spell-class-filter-for-5e":{"parentClass":"cleric"},"midi-qol":{"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.eRdyUWBs84M14oVO.Item.wjt32goECZH1NqG8"}},"img":"icons/magic/light/explosion-star-small-blue-yellow.webp","effects":[{"label":"Light","icon":"icons/magic/light/explosion-star-small-blue-yellow.webp","origin":"Actor.eRdyUWBs84M14oVO.Item.wjt32goECZH1NqG8","duration":{"seconds":3600,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"1FjJV4OUtsky1Bad","changes":[],"tint":null,"transfer":false,"flags":{"effectmacro":{"onCreate":{"script":"// icon suggestion: icons/sundries/lights/torch-brown-lit.webp\nconst dim_range = 20;\nconst bright_range = 10;\nif (token.data.light.dim === 0) {\n    await token.document.update({\n        light: {\n            alpha: 0.2,\n            angle: 0,\n            bright: bright_range,\n            coloration: 1,\n            dim: dim_range,\n            gradual: true,\n            luminosity: 0.5,\n            saturation: 0,\n            contrast: 0.25,\n            shadows: 0,\n            animation: {\n                speed: 1,\n                intensity: 2,\n                reverse: false,\n                type: \"torch\",\n            },\n            darkness: {\n                min: 0,\n                max: 1,\n            },\n            color: \"#f3e09b\",\n        },\n    });\n} else {\n    await token.document.update({\n        light: {\n            alpha: 0.5,\n            angle: 0,\n            bright: 0,\n            color: \"#000000\",\n            coloration: 1,\n            dim: 0,\n            gradual: true,\n            luminosity: 0.5,\n            saturation: 0,\n            contrast: 0,\n            shadows: 0,\n            animation: {\n                speed: 5,\n                intensity: 5,\n                reverse: false,\n            },\n            darkness: {\n                min: 0,\n                max: 1,\n            },\n        },\n    });\n}"},"onDelete":{"script":"// icon suggestion: icons/sundries/lights/torch-brown-lit.webp\nconst dim_range = 20;\nconst bright_range = 10;\nif (token.data.light.dim === 0) {\n    await token.document.update({\n        light: {\n            alpha: 0.2,\n            angle: 0,\n            bright: bright_range,\n            coloration: 1,\n            dim: dim_range,\n            gradual: true,\n            luminosity: 0.5,\n            saturation: 0,\n            contrast: 0.25,\n            shadows: 0,\n            animation: {\n                speed: 1,\n                intensity: 2,\n                reverse: false,\n                type: \"torch\",\n            },\n            darkness: {\n                min: 0,\n                max: 1,\n            },\n            color: \"#f3e09b\",\n        },\n    });\n} else {\n    await token.document.update({\n        light: {\n            alpha: 0.5,\n            angle: 0,\n            bright: 0,\n            color: \"#000000\",\n            coloration: 1,\n            dim: 0,\n            gradual: true,\n            luminosity: 0.5,\n            saturation: 0,\n            contrast: 0,\n            shadows: 0,\n            animation: {\n                speed: 5,\n                intensity: 5,\n                reverse: false,\n            },\n            darkness: {\n                min: 0,\n                max: 1,\n            },\n        },\n    });\n}"}},"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669815040073,"modifiedTime":1671041503161,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"N8tIWMR5vvjWtg5U"}
{"type":"spell","system":{"description":{"value":"<p>You call forth a bestial spirit. It manifests in an unoccupied space that you can see within range. This corporeal form uses the Bestial Spirit stat block. When you cast the spell, choose an environment: Air, Land, or Water. The creature resembles an animal of your choice that is native to the chosen environment, which determines certain traits in its stat block. The creature disappears when it drops to 0 hit points or when the spell ends.</p>\n<p>The creature is an ally to you and your companions. In combat, the creature shares your initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don’t issue any, it takes the Dodge action and uses its move to avoid danger.</p>\n<p><em><strong>At Higher Levels.</strong></em> When you cast this spell using a spell slot of 3rd level or higher, use the higher level wherever the spell’s level appears in the stat block.</p>\n<div class=\"Basic-Text-Frame stat-block-finder\">\n<p class=\"Stat-Block-Styles_Stat-Block-Title\">Bestial Spirit</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Metadata\">Small beast</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Data\"><strong>Armor Class</strong> 11 + the level of the spell (natural armor)</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Data\"><strong>Hit Points</strong> 20 (Air only) or 30 (Land and Water only) + 5 for each spell level above 2nd</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Data\"><strong>Speed</strong> 30 ft.; climb 30 ft. (Land only); fly 60 ft. (Air only); swim 30 ft. (Water only)</p>\n<div class=\"stat-block-ability-scores\">\n<div class=\"stat-block-ability-scores-stat\">\n<div class=\"stat-block-ability-scores-heading\">STR</div>\n<div class=\"stat-block-ability-scores-data\"><span class=\"stat-block-ability-scores-score\">18</span> <span class=\"stat-block-ability-scores-modifier\">(+4)</span></div>\n</div>\n<div class=\"stat-block-ability-scores-stat\">\n<div class=\"stat-block-ability-scores-heading\">DEX</div>\n<div class=\"stat-block-ability-scores-data\"><span class=\"stat-block-ability-scores-score\">11</span> <span class=\"stat-block-ability-scores-modifier\">(+0)</span></div>\n</div>\n<div class=\"stat-block-ability-scores-stat\">\n<div class=\"stat-block-ability-scores-heading\">CON</div>\n<div class=\"stat-block-ability-scores-data\"><span class=\"stat-block-ability-scores-score\">16</span> <span class=\"stat-block-ability-scores-modifier\">(+3)</span></div>\n</div>\n<div class=\"stat-block-ability-scores-stat\">\n<div class=\"stat-block-ability-scores-heading\">INT</div>\n<div class=\"stat-block-ability-scores-data\"><span class=\"stat-block-ability-scores-score\">4</span> <span class=\"stat-block-ability-scores-modifier\">(−3)</span></div>\n</div>\n<div class=\"stat-block-ability-scores-stat\">\n<div class=\"stat-block-ability-scores-heading\">WIS</div>\n<div class=\"stat-block-ability-scores-data\"><span class=\"stat-block-ability-scores-score\">14</span> <span class=\"stat-block-ability-scores-modifier\">(+2)</span></div>\n</div>\n<div class=\"stat-block-ability-scores-stat\">\n<div class=\"stat-block-ability-scores-heading\">CHA</div>\n<div class=\"stat-block-ability-scores-data\"><span class=\"stat-block-ability-scores-score\">5</span> <span class=\"stat-block-ability-scores-modifier\">(−3)</span></div>\n</div>\n</div>\n<p class=\"Stat-Block-Styles_Stat-Block-Data\"><strong>Senses</strong> @Compendium[dnd5e.rules.eVtpEGXjA2tamEIJ]{darkvision} 60 ft., passive @Compendium[dnd5e.rules.0AGfrwZRzSG0vNKb]{Perception} 12</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Data\"><strong>Languages</strong> understands the languages you speak</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Data-Last\"><strong>Challenge</strong> — <strong>Proficiency Bonus</strong> equals your bonus</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Body\"><em><strong>Flyby (Air Only).</strong></em> The beast doesn’t provoke opportunity attacks when it flies out of an enemy’s reach.</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Body\"><em><strong>Pack Tactics (Land and Water Only).</strong></em> The beast has advantage on an attack roll against a creature if at least one of the beast’s allies is within 5 feet of the creature and the ally isn’t @Compendium[dnd5e.rules.w7eitkpD7QQTB6j0]{incapacitated}.</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Body\"><em><strong>Water Breathing (Water Only).</strong></em> The beast can breathe only underwater.</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Heading\">Actions</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Body\"><em><strong>Multiattack.</strong></em> The beast makes a number of attacks equal to half this spell’s level (rounded down).</p>\n<p class=\"Stat-Block-Styles_Stat-Block-Body\"><em><strong>Maul.</strong> Melee Weapon Attack:</em> your spell attack modifier to hit, reach 5 ft., one target. <em>Hit:</em> 1d8 + 4 + the spell’s level piercing damage.</p>\n</div>","chat":"","unidentified":""},"source":"Tasha’s Cauldron of Everything pg 109","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"hour"},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":90,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":2,"school":"con","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"a feather, tuft of fur, and fish tail inside a gilded acorn worth at least 200 gp","consumed":false,"cost":200,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"name":"Summon Beast","flags":{"ddbimporter":{"id":5854852,"definitionId":721187,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Druid","level":6,"characterClassId":103206845,"spellLevel":2,"ability":"wis","mod":3,"dc":14,"cantripBoost":false,"overrideDC":false,"id":5854852,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Summon Beast","sources":[{"sourceId":67,"pageNumber":109,"sourceType":1}],"tags":["Summoning"],"version":"3.2.2","importId":"CD1IaXD1fjvLJfwV"},"spell-class-filter-for-5e":{"parentClass":"druid"},"itemacro":{"macro":{"name":"Summon Beast","type":"script","scope":"global","command":"/**\n * Item-Macro Macro onCreation for the Summon Beast Spell, until now only tested from Control Bar.\n * \n * https://www.dndbeyond.com/spells/summon-beast\n * \n * TODO: clean up logging (pretty much remove, or put all to Tablerules logging with .debug() )\n */\n\nconst macroLabel = \"Summon Beast\";\nconst textureLand = \"modules/Tablerules/icons/magic/summons/Einhornchen_Medium_Spirit_01.webp\";\nconst textureAir = \"modules/Tablerules/icons/magic/summons/Quipper_Tiny_Spirit_01.webp\";\nconst textureWater = \"modules/Tablerules/icons/magic/summons/Giant_Octopus_Large_Spirit_01.webp\";\n\nconst addGlow = true;\nconst addBlur = true;\n\n//  from context (Item-Macro), drag Item in Control Bar for Control Bar use with selecting. Use next line for Control Bar without Selection providing the name (ID would be better)\n//actor = game.actors.getName(\"Jorrick\");\n\n// TODO: get from context\nconst item = actor.items.getName(\"Summon Beast\");\n\nconsole.log({ message: macroLabel, actor: actor, item: item, arguments: arguments });\n\n\nconst level = await warpgate.dnd5e.rollItem(item);\n\nconsole.log({ message: macroLabel, level: level, arguments: arguments });\n\nif (!level > 0) {\n    return;\n}\n\nconst summonerDc = actor.data.data.attributes.spelldc;\nconst summonerAttack = summonerDc - 8;\n\n/* Prompt the user for which type of spirit to summon */\nconst buttonData = {\n    buttons: [{\n        label: \"Bestial Spirit Land\",\n        value: {\n            token: { name: \"Bestial Spirit Land\" },\n            actor: { name: \"Bestial Spirit Land\" },\n            embedded: {\n                Item: {\n                    \"Flyby\": warpgate.CONST.DELETE,\n                    \"Water Breathing\": warpgate.CONST.DELETE\n                }\n            }\n        }\n    }, {\n        label: \"Bestial Spirit Air\",\n        value: {\n            actor: { name: \"Bestial Spirit Air\" },\n            token: { name: \"Bestial Spirit Air\" },\n            embedded: {\n                Item: {\n                    \"Pack Tactics\": warpgate.CONST.DELETE,\n                    \"Water Breathing\": warpgate.CONST.DELETE\n                }\n            }\n        }\n    }, {\n        label: \"Bestial Spirit Water\",\n        value: {\n            actor: { name: \"Bestial Spirit Water\" },\n            token: { name: \"Bestial Spirit Water\" },\n            embedded: {\n                Item: {\n                    \"Flyby\": warpgate.CONST.DELETE,\n                    \"Pack Tactics\": warpgate.CONST.DELETE\n                }\n            }\n        }\n    }\n    ], title: \"Which version?\"\n};\n\nlet spirit = await warpgate.buttonDialog(buttonData);\nconsole.log({ message: macroLabel, spirit: spirit });\n\n/* Craft the updates that are common to all spirits */\nlet updates = {\n    token: {\n        \"displayName\": CONST.TOKEN_DISPLAY_MODES.HOVER,\n        \"flags.Tablerules.spellLevel\": level\n    },\n    actor: {\n        'system.attributes.ac.flat': 11 + level,\n        'system.attributes.hp': { value: 30 + 5 * (level - 2), max: 30 + 5 * (level - 2) },\n    },\n    embedded: {\n        Item: {\n            \"Multiattack\": { name: `Multiattack (${Math.floor(level / 2)} attacks)` },\n            \"Maul\": {\n                'system.damage.parts': [[`1d8 + 4 + ${level}`, \"piercing\"]],\n                'system.attackBonus': `- @mod - @prof + ${summonerAttack}`,\n            }\n        }\n    }\n}\n\n/* update variants */\nif (spirit.actor.name === \"Bestial Spirit Land\") {\n    updates[\"actor.img\"] = textureLand;\n    updates[\"token.texture.src\"] = textureLand;\n}\n\nif (spirit.actor.name === \"Bestial Spirit Air\") {\n    console.log({ message: `${macroLabel}, updating variants (${spirit.actor.name})` });\n    updates['actor.system.attributes.hp'] = { value: 20 + 5 * (level - 2), max: 20 + 5 * (level - 2) };\n    updates[\"actor.img\"] = textureAir;\n    updates[\"token.texture.src\"] = textureAir;\n}\n\nif (spirit.actor.name === \"Bestial Spirit Water\") {\n    updates[\"actor.img\"] = textureWater;\n    updates[\"token.texture.src\"] = textureWater;\n}\n\n/* Combine the general and specific updates */\nupdates = mergeObject(updates, spirit);\n\nconst spawnIds = await warpgate.spawn(\"Bestial Spirit\", updates);\n\nconst spawn = canvas.tokens.get(spawnIds[0]); // or canvas.scene.tokens.get(id) to get the document immediately\n\nconsole.log({ message: macroLabel, spawn: spawn, spawnIds: spawnIds });\n\nfor (let i = 0; i < spawnIds.length; i++) {\n    s = canvas.tokens.get(spawnIds[i]);\n}","author":"npmYF618vZgxA5SD","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.PG4shx9GXNLPo6dx.Item.jBRTbuFT4z8CFM8G"}},"img":"icons/commodities/claws/claw-bear-brown-grey.webp","effects":[],"ownership":{"default":0,"npmYF618vZgxA5SD":3,"YCF2Heb7DMHDaF2f":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.4","coreVersion":"10.291","createdTime":1669495980778,"modifiedTime":1676305225773,"lastModifiedBy":"YCF2Heb7DMHDaF2f"},"folder":null,"sort":0,"_id":"NIHnsHVcuxtCpL7B"}
{"type":"spell","system":{"description":{"value":"<p>Your spell bolsters your allies with toughness and resolve. Choose up to three creatures within range. Each target's hit point maximum and current hit points increase by 5 for the duration.</p>\n<p><em><strong>At Higher Levels.</strong></em> When you cast this spell using a spell slot of 3rd level or higher, a target's hit points increase by an additional 5 for each slot level above 2nd.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 211","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":8,"units":"hour"},"target":{"value":3,"width":null,"units":"","type":"creature"},"range":{"value":30,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["5","healing"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":2,"school":"abj","components":{"value":"a tiny strip of white cloth","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"a tiny strip of white cloth","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"(@item.level - 2) * 5"}},"name":"Aid","flags":{"ddbimporter":{"id":136020,"definitionId":1990,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Cleric","level":10,"characterClassId":116804531,"spellLevel":2,"ability":"wis","mod":3,"dc":15,"cantripBoost":false,"overrideDC":false,"id":136020,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Aid","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":211,"sourceType":1}],"tags":["Buff"],"version":"3.2.5","importId":"QZvF1RLtxqetgW6P"},"spell-class-filter-for-5e":{"parentClass":"cleric"},"midi-qol":{"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.8ugKnRSqQzxSxrZO.Item.lkEkZJQWgyvPUigR"}},"img":"icons/magic/life/heart-cross-strong-blue.webp","effects":[{"label":"Aid","icon":"icons/magic/life/heart-cross-strong-blue.webp","origin":"Actor.8ugKnRSqQzxSxrZO.Item.lkEkZJQWgyvPUigR","duration":{"seconds":28800,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"B97VzuSbScI7mJOh","changes":[{"key":"system.attributes.hp.tempmax","mode":2,"value":"+5","priority":20}],"tint":null,"transfer":false,"flags":{"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"effectmacro":{"onCreate":{"script":"const castLevel = effect.flags[\"effective-transferral\"].castData.castLevel;\n\nconst changes = effect.changes;\nconst tempmax = castLevel * 5 - 5;\nchanges[0].value = tempmax;\n\nawait effect.update({ changes: changes });\nawait actor.update({ \"system.attributes.hp.value\": actor.system.attributes.hp.value + tempmax });\n"},"onDelete":{"script":"await actor.update({ \"system.attributes.hp.value\": Math.min(actor.system.attributes.hp.value, actor.system.attributes.hp.max) });"}}}}],"ownership":{"default":0,"npmYF618vZgxA5SD":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669848893063,"modifiedTime":1671041526847,"lastModifiedBy":"npmYF618vZgxA5SD"},"folder":null,"sort":0,"_id":"PdQt53wccy7nBKvT"}
{"type":"spell","system":{"description":{"value":"<p>The next time you hit a creature with a melee weapon attack during the spell’s duration, your weapon flares with white-hot intensity, and the attack deals an extra 1d6 fire damage to the target and causes the target to ignite in flames. At the start of each of its turns until the spell ends, the target must make a Constitution saving throw. On a failed save, it takes 1d6 fire damage. On a successful save, the spell ends. If the target or a creature within 5 feet of it uses an action to put out the flames, or if some other effect douses the flames (such as the target being submerged in water), the spell ends.</p>\n<p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 2nd level or higher, the initial extra damage dealt by the attack increases by 1d6 for each slot.</p>","chat":"","unidentified":""},"source":"Player's Handbook pg 274","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":null,"width":null,"units":"","type":"creature"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["1d6[fire - Initial Damage]","fire"]],"versatile":""},"formula":"1d6[fire - At the start of each of the target's turns until the spell ends]","save":{"ability":"con","dc":null,"scaling":"spell"},"level":1,"school":"evo","components":{"value":"","vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"level","formula":"1d6"}},"name":"Searing Smite","flags":{"ddbimporter":{"id":138679,"definitionId":2319,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Paladin","level":2,"characterClassId":118222921,"spellLevel":1,"ability":"cha","mod":3,"dc":13,"cantripBoost":false,"overrideDC":false,"id":138679,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Searing Smite","sources":[{"sourceId":2,"pageNumber":274,"sourceType":1}],"tags":["Damage"],"version":"3.2.4","importId":"nr2pP3wJUbGAzZXf"},"spell-class-filter-for-5e":{"parentClass":"paladin"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.NpZ7SoVLhrnuRzQX.Item.XvbPvuxm9uFSVCo5"}},"img":"icons/magic/fire/dagger-rune-enchant-flame-orange.webp","effects":[{"label":"Searing Smite","icon":"icons/magic/fire/dagger-rune-enchant-flame-orange.webp","origin":"Actor.99cEYTlhTD08gmgQ.Item.XvbPvuxm9uFSVCo5","duration":{"seconds":60,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"qWUgYzZSpUYf2IOL","changes":[],"tint":null,"transfer":false,"flags":{"effectmacro":{"onCreate":{"script":"let params =\n[{\n    filterType: \"fire\",\n    filterId: \"SearingSmite\",\n    intensity: 1,\n    color: 0xFFFFFF,\n    amplitude: 1,\n    time: 0,\n    blend: 2,\n    fireBlend : 1,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0024, \n        animType: \"move\" \n      },\n      intensity:\n      {\n        active:true,\n        loopDuration: 15000,\n        val1: 0.8,\n        val2: 2,\n        animType: \"syncCosOscillation\"\n      },\n      amplitude:\n      {\n        active:true,\n        loopDuration: 4400,\n        val1: 1,\n        val2: 1.4,\n        animType: \"syncCosOscillation\"\n      }\n      \n    }\n}];\n\nawait TokenMagic.addUpdateFilters(token, params);"},"onDelete":{"script":"await TokenMagic.deleteFilters(token, \"SearingSmite\");"}},"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669692144776,"modifiedTime":1671041506216,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"QFcyjacV53RG8Tcy"}
{"type":"spell","system":{"description":{"value":"<p>For the duration, you sense the presence of magic within 30 feet of you. If you sense magic in this way, you can use your action to see a faint aura around any visible creature or object in the area that bears magic, and you learn its school of magic, if any.</p>\n<p>The spell can penetrate most barriers, but it is blocked by 1 foot of stone, 1 inch of common metal, a thin sheet of lead, or 3 feet of wood or dirt.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 231","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":10,"units":"minute"},"target":{"value":30,"width":null,"units":"ft","type":"sphere"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"div","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":true,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"none","formula":""}},"name":"Detect Magic","flags":{"ddbimporter":{"id":136567,"definitionId":2065,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Wizard","level":1,"characterClassId":108474208,"spellLevel":1,"ability":"int","mod":3,"dc":13,"cantripBoost":false,"overrideDC":false,"id":136567,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Detect Magic","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":231,"sourceType":1}],"tags":["Detection"],"version":"3.2.4","importId":"EgKCIFc1BkVC5JrI"},"spell-class-filter-for-5e":{"parentClass":"wizard"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.ZhhF2ZWDPIY2g3KI.Item.C2MFK8tsznV4ryvc"}},"img":"icons/magic/light/explosion-star-blue.webp","effects":[],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669500366062,"modifiedTime":1671041494354,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"SjenB4LwmEUHx8q2"}
{"type":"spell","system":{"description":{"value":"<p>You bless up to three creatures of your choice within range. Whenever a target makes an attack roll or a saving throw before the spell ends, the target can roll a d4 and add the number rolled to the attack roll or saving throw.</p>\n<p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 2nd level or higher, you can target one additional creature for each slot level above 1st.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 219","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":3,"width":null,"units":"","type":"creature"},"range":{"value":30,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"enc","components":{"value":"a sprinkling of holy water","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"a sprinkling of holy water","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"none","formula":""}},"name":"Bless","flags":{"ddbimporter":{"id":136126,"definitionId":2016,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Cleric","level":10,"characterClassId":116804531,"spellLevel":1,"ability":"wis","mod":3,"dc":15,"cantripBoost":false,"overrideDC":false,"id":136126,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Bless","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":219,"sourceType":1}],"tags":["Buff"],"version":"3.2.4","importId":"HK5s4atPMmweQr7v"},"spell-class-filter-for-5e":{"parentClass":"cleric"},"midi-qol":{"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.eRdyUWBs84M14oVO.Item.NWATHmrIMp4A5gBK"}},"img":"icons/magic/life/cross-worn-green.webp","effects":[{"label":"Bless","icon":"icons/magic/life/cross-worn-green.webp","origin":"Actor.eRdyUWBs84M14oVO.Item.NWATHmrIMp4A5gBK","duration":{"seconds":60,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"oh2s8CE7ILvwiCJs","changes":[{"key":"system.bonuses.abilities.save","mode":2,"value":"+1d4","priority":20},{"key":"system.bonuses.All-Attacks","mode":2,"value":"+1d4","priority":20}],"tint":null,"transfer":false,"flags":{"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""}}}],"ownership":{"default":0,"npmYF618vZgxA5SD":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669815040080,"modifiedTime":1671041577079,"lastModifiedBy":"npmYF618vZgxA5SD"},"folder":null,"sort":0,"_id":"ZyTTysGFWVOLfhD2"}
{"type":"spell","system":{"description":{"value":"<p>A shimmering field appears and surrounds a creature of your choice within range, granting it a +2 bonus to AC for the duration.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 275","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":10,"units":"minute"},"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"wis","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"abj","components":{"value":"a small parchment with a bit of holy text written on it","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"a small parchment with a bit of holy text written on it","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"name":"Shield of Faith","flags":{"ddbimporter":{"id":138705,"definitionId":2248,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Cleric","level":1,"characterClassId":118182112,"spellLevel":1,"ability":"wis","mod":2,"dc":12,"cantripBoost":false,"overrideDC":false,"id":138705,"entityTypeId":435869154,"healingBoost":2,"usesSpellSlot":true},"originalName":"Shield of Faith","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":275,"sourceType":1}],"tags":["Buff","Warding"],"version":"3.2.4","importId":"XpwygIbTgqS9zbhX"},"spell-class-filter-for-5e":{"parentClass":"cleric"},"midi-qol":{"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"offHandWeapon":false},"core":{"sourceId":"Actor.jItLUReNSJ6NAwL3.Item.uOwpX3Orz3RHnhKB"}},"img":"icons/magic/defensive/shield-barrier-flaming-diamond-blue-yellow.webp","effects":[{"label":"Shield of Faith","icon":"icons/magic/defensive/shield-barrier-flaming-diamond-blue-yellow.webp","origin":"Actor.3IDJAqCn3WKSy8xf.Item.uOwpX3Orz3RHnhKB","duration":{"seconds":600,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"3mEM10uASGd484fH","changes":[{"key":"system.attributes.ac.bonus","mode":2,"value":"+2","priority":20}],"tint":null,"transfer":false,"flags":{"effectmacro":{"onCreate":{"script":"let params =\n[{\n    filterType: \"glow\",\n    filterId: \"ShieldOfFaith\",\n    outerStrength: 4,\n    innerStrength: 0,\n    color: 0x5099DD,\n    quality: 0.5,\n    padding: 10,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0xfff24f, \n           val2:0xfffabc\n        }\n    }\n}];\n\nawait TokenMagic.addUpdateFilters(token, params);"},"onDelete":{"script":"await TokenMagic.deleteFilters(token, \"ShieldOfFaith\");"}},"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669694313364,"modifiedTime":1671041511188,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"aBCrWIv0N7jegL70"}
{"type":"spell","system":{"description":{"value":"<p>An @Compendium[dnd5e.rules.w7eitkpD7QQTB6j0]{invisible} barrier of magical force appears and protects you. Until the start of your next turn, you have a +5 bonus to AC, including against the triggering attack, and you take no damage from <strong>magic missile</strong>.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 275","activation":{"type":"reaction","cost":1,"condition":"which you take when you are hit by an attack or targeted by the magic missile spell"},"duration":{"value":"1","units":"round"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"abj","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"none","formula":""}},"name":"Shield","flags":{"ddbimporter":{"id":138703,"definitionId":2247,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Wizard","level":2,"characterClassId":124817896,"spellLevel":1,"ability":"int","mod":3,"dc":13,"cantripBoost":false,"overrideDC":false,"id":138703,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Shield","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":275,"sourceType":1}],"tags":["Warding"],"version":"3.3.8","importId":"hCa0W5gTxkWEg7lw"},"spell-class-filter-for-5e":{"parentClass":"wizard"},"core":{"sourceId":"Actor.pvWHemzJIHEPighO.Item.8svFBLGjOt9ETVQ1"}},"img":"icons/equipment/shield/kite-wooden-oak-glow.webp","effects":[{"label":"Shield","icon":"icons/equipment/shield/kite-wooden-oak-glow.webp","origin":"Actor.pvWHemzJIHEPighO.Item.8svFBLGjOt9ETVQ1","duration":{"rounds":1,"startTime":null,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"TRE7zREJuLxoZI3y","changes":[{"key":"system.attributes.ac.bonus","mode":2,"value":"+5","priority":20}],"tint":null,"transfer":false,"flags":{"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false},"transferrable":{"self":true,"target":true}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"effectmacro":{"onCreate":{"script":"let params =\n[{\n    filterType: \"field\",\n    filterId: \"shield\",\n    shieldType: 6,\n    gridPadding: 1.2,\n    color: 0x7090AA,\n    time: 0,\n    blend: 1,\n    intensity: 1,\n    lightAlpha: 1,\n    lightSize: 0.7,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    zOrder: 512,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\n\nawait TokenMagic.addUpdateFiltersOnSelected(params);"},"onDelete":{"script":"await TokenMagic.deleteFilters(token, \"shield\");"}}}}],"ownership":{"default":0,"npmYF618vZgxA5SD":3,"YCF2Heb7DMHDaF2f":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.4","coreVersion":"10.291","createdTime":1676044486986,"modifiedTime":1676305198872,"lastModifiedBy":"YCF2Heb7DMHDaF2f"},"folder":null,"sort":0,"_id":"hKXyDZ4DMEwZVxvc"}
{"type":"spell","system":{"description":{"value":"<p>Healing energy radiates from you in an aura with a 30-foot radius. Until the spell ends, the aura moves with you, centered on you. You can use a bonus action to cause one creature in the aura (including you) to regain 2d6 hit points.</p>","chat":"","unidentified":""},"source":"Player's Handbook pg 216","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":30,"width":null,"units":"ft","type":"sphere"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"heal","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["2d6[healing - You can use a bonus action to target one creature in the aura (including you)]","healing"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"evo","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"name":"Aura of Vitality","flags":{"ddbimporter":{"id":114228,"definitionId":2333,"entityTypeId":341470558,"dndbeyond":{"lookup":"classSpell","class":"Cleric","level":10,"characterClassId":124598396,"spellLevel":3,"ability":"wis","mod":3,"dc":15,"cantripBoost":false,"overrideDC":false,"id":114228,"entityTypeId":341470558,"healingBoost":0,"usesSpellSlot":true},"originalName":"Aura of Vitality","sources":[{"sourceId":2,"pageNumber":216,"sourceType":1}],"tags":["Healing"],"version":"3.3.8","importId":"HuXnFYz1RK9PZoO1"},"spell-class-filter-for-5e":{"parentClass":"cleric"},"itemacro":{"macro":{"name":"Aura of Vitality","type":"script","scope":"global","command":"/**\n * Item-Macro (planned) for Aura of Vitality Item (Spell)\n * \n * https://www.dndbeyond.com/spells/aura-of-vitality\n * \n * Aura of Vitality Issue #31\n */\n\nconst macroLabel = \"Aura of Vitality\";\nconst icon = \"icons/magic/air/air-burst-spiral-pink.webp\";\nconst flagKey = \"flags.world.auraOfVitality\";\nconst checkRange = false;\nconst useDistance3D = true;\nconst useMouseHover = false;\n\nlet templates = canvas.scene.templates.filter(t => t.flags.dnd5e !== undefined).filter(t => t.flags.dnd5e.origin === item.uuid);\nlet template = templates[0];\n\nlet target = null;\n\n// check if the \"aura\" is up (if there is the MeasuringTemplate with our flag)\nif (typeof template !== \"undefined\") {\n\n    if (useMouseHover) {\n        // check for hovered and try to heal if valid\n        target = canvas.tokens.hover;\n        if (canvas.tokens.hover === null) {\n            ui.notifications.warn(`${macroLabel}, Actor hovered ${actor?.name} invalid target (no Actor found).`);\n            return;\n        }\n    } else {\n        target = game.user.targets.first();\n    }\n\n    // check range and abort if to far, for corner-cases roll in dice tray or temporarily move one of the tokens.\n    const tokenSource = token;\n    const tokenTarget = target;\n    const distance = Math.round(canvas.grid.measureDistance(tokenSource, tokenTarget, { gridSpaces: true }));\n    const distance3D = Math.round(Math.sqrt(distance * distance + (tokenSource.document.elevation - tokenTarget.document.elevation) * (tokenSource.document.elevation - tokenTarget.document.elevation)));\n\n    if (checkRange && (useDistance3D ? distance3D : distance) > 30) {\n        ui.notifications.warn(\n            `Distance between ${token.actor.name} and ${target.actor.name} is ${(useDistance3D ? distance3D : distance)}. Expected distance<=30.`,\n            { permanent: true }\n        );\n\n        return;\n    }\n\n    const effect = actor.effects.find(e => e.flags?.world?.origin === item.uuid);\n    const spellLevel = effect.flags.world.spellLevel;\n\n    const isDiscipleOfLife = actor.classes?.cleric?.system?.subclass?.identifier === \"life-domain\";\n    let bonusHealing = 5; //spellLevel + 2\n    if (isDiscipleOfLife) {\n        bonusHealing += spellLevel + 2;\n    }\n    const bonusHealingString = bonusHealing !== 0 ? `+${bonusHealing}` : \"\";\n\n    const dice = target.actor.items.filter(i => i.name === (\"Eldritch Invocations: Gift of the Ever-Living Ones\")).length > 0 ? \"12\" : \"2d6\";\n    const roll = await new Roll(`${dice}${bonusHealing !== 0 ? bonusHealingString : \"\"}`, actor.getRollData()).evaluate({ async: true });\n    const hpHealed = roll.total;\n    roll.toMessage({\n        speaker: ChatMessage.getSpeaker({ actor: token.actor }),\n        flavor: `${macroLabel}, healing ${target.name} for ${hpHealed}hp.`\n    });\n    const requestorData = [{ uuid: target.document.uuid, healing: hpHealed }];\n\n    // request healing\n    await Requestor.request({\n        title: `${macroLabel}`,\n        description: `healing ${target.name} for ${hpHealed}hp, ${effect.flags.world.charges} charges left.`,\n        img: icon,\n        whisper: [game.users.getName(\"Gamemaster\").id],\n        buttonData: [{\n            label: `${target.name.substr(0, 6)} +${hpHealed}[heal], ${effect.flags.world.charges} charges`,\n            limit: Requestor.LIMIT.ONCE,\n            permission: Requestor.PERMISSION.GM,\n            action: async () => {\n                for (let i = 0; i < this.requestorData.length; i++) {\n                    await canvas.tokens.placeables.find(t => t.document.uuid === this.requestorData[i].uuid).actor.applyDamage(-this.requestorData[i].healing)\n                }\n            },\n            requestorData: requestorData // what is here gets into this.<something>\n        }]\n    });\n\n\n    const charges = 10;\n    const effectData = { icon, label: `${macroLabel} (${charges})` };\n    foundry.utils.setProperty(effectData, \"flags.world.spellLevel\", spellLevel);\n    foundry.utils.setProperty(effectData, \"flags.world.charges\", 10);\n    foundry.utils.setProperty(effectData, \"flags.world.origin\", item.uuid);\n\n    await effect.update({\n        label: `${macroLabel} (${effect.flags.world.charges - 1})`,\n        \"flags.world.charges\": effect.flags.world.charges - 1\n    });\n\n    return;\n}\n\n// use the item (takes care of resources, ChatMessage), if returning null (i believe) return\nconst use = await item.use();\nif (!use) {\n    return;\n}\nconst DIV = document.createElement(\"DIV\");\nDIV.innerHTML = use.content;\nconst spellLevel = Number(DIV.firstChild.dataset.spellLevel);\n\n\n// select the MeasuringTemplate created by the Item.Spell use() and modify\ntemplate = canvas.scene.templates.filter(t => t.flags.dnd5e !== undefined).filter(t => t.flags.dnd5e.origin === item.uuid)[0];\n\nconst templateData = {\n    borderColor: \"#00800f\",\n    fillColor: \"#022400\",\n    x: token.center.x,\n    y: token.center.y\n};\nawait template.update(templateData);\nawait tokenAttacher.attachElementsToToken([template], token);\n\nconst charges = 10;\nconst effectData = { icon, label: `${macroLabel} (${charges})` };\nfoundry.utils.setProperty(effectData, \"flags.world.spellLevel\", spellLevel);\nfoundry.utils.setProperty(effectData, \"flags.world.charges\", 10);\nfoundry.utils.setProperty(effectData, \"flags.world.origin\", item.uuid);\nawait actor.createEmbeddedDocuments(\"ActiveEffect\", [effectData]);","author":"YCF2Heb7DMHDaF2f","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.QLc7cJv6mcLw7ixj.Item.Rqf1728uAtt9fglH"}},"img":"icons/magic/life/cross-area-circle-green-white.webp","effects":[{"label":"Aura of Vitality","icon":"icons/magic/life/cross-area-circle-green-white.webp","origin":"Actor.QLc7cJv6mcLw7ixj.Item.Rqf1728uAtt9fglH","duration":{"seconds":60,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"DudGC8XWDVNDAwkk","changes":[],"tint":null,"transfer":false,"flags":{}}],"ownership":{"default":0,"YCF2Heb7DMHDaF2f":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.4","coreVersion":"10.291","createdTime":1676130280082,"modifiedTime":1676305126086,"lastModifiedBy":"YCF2Heb7DMHDaF2f"},"folder":null,"sort":0,"_id":"o765P2hrQacbcTvT"}
{"type":"spell","system":{"description":{"value":"<p>A flash of light streaks toward a creature of your choice within range. Make a ranged spell attack against the target. On a hit, the target takes 4d6 radiant damage, and the next attack roll made against this target before the end of your next turn has advantage, thanks to the mystical dim light glittering on the target until then.</p>\n<p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d6 for each slot level above 1st.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 248","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"round"},"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":120,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"rsak","attackBonus":"0","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["4d6[radiant]","radiant"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"evo","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"level","formula":"1d6"}},"name":"Guiding Bolt","flags":{"ddbimporter":{"id":138023,"definitionId":2133,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Cleric","level":10,"characterClassId":116804531,"spellLevel":1,"ability":"wis","mod":3,"dc":15,"cantripBoost":false,"overrideDC":false,"id":138023,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Guiding Bolt","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":248,"sourceType":1}],"tags":["Damage","Buff"],"version":"3.2.4","importId":"HK5s4atPMmweQr7v"},"spell-class-filter-for-5e":{"parentClass":"cleric"},"midi-qol":{"fumbleThreshold":null,"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.eRdyUWBs84M14oVO.Item.uR59ZwbfhzSyhVep"}},"img":"icons/magic/fire/flame-burning-hand-purple.webp","effects":[{"label":"Guiding Bolt","icon":"icons/magic/fire/flame-burning-hand-purple.webp","origin":"Actor.eRdyUWBs84M14oVO.Item.uR59ZwbfhzSyhVep","duration":{"rounds":1,"startTime":null,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"8sNF4rAEjrzqPS6C","changes":[],"tint":null,"transfer":false,"flags":{"effectmacro":{"onCreate":{"script":"let params =\n[{\n    filterType: \"glow\",\n    filterId: \"GuidingBolt\",\n    outerStrength: 4,\n    innerStrength: 0,\n    color: 0x5099DD,\n    quality: 0.5,\n    padding: 10,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0xfff24f, \n           val2:0xfffabc\n        }\n    }\n}];\n\nawait TokenMagic.addFilters(token, params);"},"onDelete":{"script":"await TokenMagic.deleteFilters(token, \"GuidingBolt\");"}},"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""}}}],"ownership":{"default":0,"npmYF618vZgxA5SD":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669815040088,"modifiedTime":1671041582788,"lastModifiedBy":"npmYF618vZgxA5SD"},"folder":null,"sort":0,"_id":"rByvD0KaB3KuDsva"}
{"type":"spell","system":{"description":{"value":"<p>An @Compendium[dnd5e.rules.w7eitkpD7QQTB6j0]{invisible} barrier of magical force appears and protects you. Until the start of your next turn, you have a +5 bonus to AC, including against the triggering attack, and you take no damage from <strong>magic missile</strong>.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 275","activation":{"type":"reaction","cost":1,"condition":"which you take when you are hit by an attack or targeted by the magic missile spell"},"duration":{"value":1,"units":"round"},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"abj","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"name":"Shield","flags":{"ddbimporter":{"id":138703,"definitionId":2247,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Wizard","level":1,"characterClassId":108474208,"spellLevel":1,"ability":"int","mod":3,"dc":13,"cantripBoost":false,"overrideDC":false,"id":138703,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Shield","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":275,"sourceType":1}],"tags":["Warding"],"version":"3.2.4","importId":"EgKCIFc1BkVC5JrI"},"spell-class-filter-for-5e":{"parentClass":"wizard"},"midi-qol":{"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"offHandWeapon":false},"core":{"sourceId":"Actor.ZhhF2ZWDPIY2g3KI.Item.zNiQsoM34KovpPu5"}},"img":"icons/magic/defensive/shield-barrier-glowing-triangle-magenta.webp","effects":[{"label":"Shield","icon":"icons/magic/defensive/shield-barrier-glowing-triangle-magenta.webp","origin":"Actor.6jtmp2Joatnf8PuB.Item.zNiQsoM34KovpPu5","duration":{"rounds":1,"startTime":null,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"WRPIITgsqjAgKcpl","changes":[{"key":"system.attributes.ac.bonus","mode":2,"value":"+5","priority":20}],"tint":null,"transfer":false,"flags":{"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"effectmacro":{"onCreate":{"script":"let params =\n[{\n    filterType: \"glow\",\n    filterId: \"superSpookyGlow\",\n    outerStrength: 4,\n    innerStrength: 0,\n    color: 0x5099DD,\n    quality: 0.5,\n    padding: 10,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0x5099DD, \n           val2:0x90EEFF\n        }\n    }\n}];\n\nawait TokenMagic.addUpdateFiltersOnSelected(params);"},"onDelete":{"script":"// Delete all filters on the selected tokens/tiles\nawait TokenMagic.deleteFiltersOnSelected();"}}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669500366056,"modifiedTime":1671388607830,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"vyaIAXP0rWJjowM8"}
{"type":"spell","system":{"description":{"value":"<p>This spell sends creatures into a magical slumber. Roll 5d8; the total is how many hit points of creatures this spell can affect. Creatures within 20 feet of a point you choose within range are affected in ascending order of their current hit points (ignoring @Compendium[dnd5e.rules.w7eitkpD7QQTB6j0]{unconscious} creatures).</p>\n<p>Starting with the creature that has the lowest current hit points, each creature affected by this spell falls @Compendium[dnd5e.rules.w7eitkpD7QQTB6j0]{unconscious} until the spell ends, the sleeper takes damage, or someone uses an action to shake or slap the sleeper awake. Subtract each creature’s hit points from the total before moving on to the creature with the next lowest hit points. A creature’s hit points must be equal to or less than the remaining total for that creature to be affected.</p>\n<p>Undead and creatures immune to being @Compendium[dnd5e.rules.w7eitkpD7QQTB6j0]{charmed} aren’t affected by this spell.</p>\n<p><em><strong>At Higher Levels.</strong></em> When you cast this spell using a spell slot of 2nd level or higher, roll an additional 2d8 for each slot level above 1st.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 276","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":20,"width":null,"units":"ft","type":"sphere"},"range":{"value":90,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["5d8",""]],"versatile":"","value":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"enc","components":{"value":"a pinch of fine sand, rose petals, or a cricket","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"a pinch of fine sand, rose petals, or a cricket","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"2d8"}},"name":"Sleep","flags":{"ddbimporter":{"id":138731,"definitionId":2254,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Wizard","level":1,"characterClassId":108474208,"spellLevel":1,"ability":"int","mod":3,"dc":13,"cantripBoost":false,"overrideDC":false,"id":138731,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Sleep","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":276,"sourceType":1}],"tags":["Control"],"version":"3.2.4","importId":"EgKCIFc1BkVC5JrI"},"spell-class-filter-for-5e":{"parentClass":"wizard"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.ZhhF2ZWDPIY2g3KI.Item.8jZVoHpCEtzKfreQ"}},"img":"icons/magic/light/explosion-star-small-pink.webp","effects":[{"label":"Sleep","icon":"icons/magic/light/explosion-star-small-pink.webp","origin":"Actor.6jtmp2Joatnf8PuB.Item.8jZVoHpCEtzKfreQ","duration":{"seconds":60,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"KfLMB8ddvzbNsweK","changes":[],"tint":null,"transfer":false,"flags":{}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669500366054,"modifiedTime":1671041513060,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"ydiJQ9SSVlelEM2s"}
{"type":"spell","system":{"description":{"value":"<p>You touch a willing creature who isn't wearing armor, and a protective magical force surrounds it until the spell ends. The target's base AC becomes 13 + its Dexterity modifier. The spell ends if the target dons armor or if you dismiss the spell as an action.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 256","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"8","units":"hour"},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":"touch"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"abj","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"a piece of cured leather","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"none","formula":""}},"name":"Mage Armor","flags":{"ddbimporter":{"id":138432,"definitionId":2172,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Wizard","level":2,"characterClassId":124817896,"spellLevel":1,"ability":"int","mod":3,"dc":13,"cantripBoost":false,"overrideDC":false,"id":138432,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Mage Armor","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":256,"sourceType":1}],"tags":["Buff","Warding"],"version":"3.3.8","importId":"hCa0W5gTxkWEg7lw"},"spell-class-filter-for-5e":{"parentClass":"wizard"},"core":{"sourceId":"Actor.pvWHemzJIHEPighO.Item.EDY5dOTjrIxODRU0"}},"img":"icons/magic/defensive/shield-barrier-glowing-triangle-blue.webp","effects":[{"label":"Mage Armor","icon":"icons/magic/defensive/shield-barrier-glowing-triangle-blue.webp","origin":"Actor.pvWHemzJIHEPighO.Item.EDY5dOTjrIxODRU0","duration":{"seconds":28800,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"i38IHHxA7a1yKtq6","changes":[{"key":"system.attributes.ac.calc","mode":5,"value":"mage","priority":20}],"tint":null,"transfer":false,"flags":{"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false},"transferrable":{"self":true,"target":true}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"effectmacro":{"onCreate":{"script":"const default1 = 0x5099DD;\nconst default2 = 0x90EEFF;\nconst white1 = 0xFFFFFF;\nconst white2 = 0xDDDDFF;\nconst red1 = 0xFF0000;\nconst red2 = 0xFF3300;\nconst black1 = 0x4B0082;\nconst black2 = 0x2B0062;\n\nlet params =\n[{\n    filterType: \"glow\",\n    filterId: \"mageArmor\",\n    outerStrength: 4,\n    innerStrength: 0,\n    color: red1,\n    quality: 0.5,\n    padding: 10,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:red1, \n           val2:red2\n        }\n    }\n}];\n\nawait TokenMagic.addUpdateFiltersOnSelected(params);"},"onDelete":{"script":"await TokenMagic.deleteFilters(token, \"mageArmor\");"}}}}],"ownership":{"default":0,"npmYF618vZgxA5SD":3,"YCF2Heb7DMHDaF2f":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.4","coreVersion":"10.291","createdTime":1676044486985,"modifiedTime":1676305189448,"lastModifiedBy":"YCF2Heb7DMHDaF2f"},"folder":null,"sort":0,"_id":"z4d6zPC4bgTUOtpv"}
{"type":"spell","system":{"description":{"value":"<p>You bless up to three creatures of your choice within range. Whenever a target makes an attack roll or a saving throw before the spell ends, the target can roll a d4 and add the number rolled to the attack roll or saving throw.</p>\n<p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 2nd level or higher, you can target one additional creature for each slot level above 1st.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 219","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":3,"width":null,"units":"","type":"creature"},"range":{"value":30,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"wis","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"enc","components":{"value":"a sprinkling of holy water","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"a sprinkling of holy water","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"none","formula":""}},"name":"Bless","flags":{"ddbimporter":{"id":136126,"definitionId":2016,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Cleric","level":1,"characterClassId":118182112,"spellLevel":1,"ability":"wis","mod":2,"dc":12,"cantripBoost":false,"overrideDC":false,"id":136126,"entityTypeId":435869154,"healingBoost":2,"usesSpellSlot":true},"originalName":"Bless","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":219,"sourceType":1}],"tags":["Buff"],"version":"3.2.4","importId":"XpwygIbTgqS9zbhX"},"spell-class-filter-for-5e":{"parentClass":"cleric"},"midi-qol":{"effectActivation":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.jItLUReNSJ6NAwL3.Item.gahURDXkpl94Jnst"}},"img":"icons/magic/control/buff-flight-wings-blue.webp","effects":[{"label":"Bless","icon":"icons/magic/control/buff-flight-wings-blue.webp","origin":"Actor.3IDJAqCn3WKSy8xf.Item.gahURDXkpl94Jnst","duration":{"seconds":60,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"W7v9DB5pR2EpodVe","changes":[{"key":"system.bonuses.All-Attacks","mode":2,"value":"+1d4","priority":20},{"key":"system.bonuses.abilities.save","mode":2,"value":"+1d4","priority":20}],"tint":null,"transfer":false,"flags":{"effective-transferral":{"transferBlock":{"button":false,"chat":false,"displayCard":false}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1669694313366,"modifiedTime":1671041492354,"lastModifiedBy":"npmYF618vZgxA5SD"},"ownership":{"default":0,"npmYF618vZgxA5SD":3},"folder":null,"sort":0,"_id":"zLqb912CTOFMMahB"}
{"type":"spell","system":{"description":{"value":"<p>Healing energy radiates from you in an aura with a 30-foot radius. Until the spell ends, the aura moves with you, centered on you. You can use a bonus action to cause one creature in the aura (including you) to regain 2d6 hit points.</p>","chat":"","unidentified":""},"source":"Player's Handbook pg 216","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":30,"width":null,"units":"ft","type":"sphere"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"heal","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["2d6[healing - You can use a bonus action to target one creature in the aura (including you)]","healing"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"evo","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"name":"Aura of Vitality","flags":{"ddbimporter":{"id":114228,"definitionId":2333,"entityTypeId":341470558,"dndbeyond":{"lookup":"classSpell","class":"Cleric","level":10,"characterClassId":124598396,"spellLevel":3,"ability":"wis","mod":3,"dc":15,"cantripBoost":false,"overrideDC":false,"id":114228,"entityTypeId":341470558,"healingBoost":0,"usesSpellSlot":true},"originalName":"Aura of Vitality","sources":[{"sourceId":2,"pageNumber":216,"sourceType":1}],"tags":["Healing"],"version":"3.3.8","importId":"HuXnFYz1RK9PZoO1"},"spell-class-filter-for-5e":{"parentClass":"cleric"},"itemacro":{"macro":{"name":"Aura of Vitality","type":"script","scope":"global","command":"/**\n * Item-Macro (planned) for Aura of Vitality Item (Spell)\n * \n * https://www.dndbeyond.com/spells/aura-of-vitality\n * \n * Aura of Vitality Issue #31\n */\n\nconst macroLabel = \"Aura of Vitality\";\nconst icon = item.img; // \"icons/magic/air/air-burst-spiral-pink.webp\";\nconst flagKey = \"flags.world.auraOfVitality\";\nconst checkRange = false;\nconst useDistance3D = true;\nconst useMouseHover = false;\n\nlet templates = canvas.scene.templates.filter(t => t.flags.dnd5e !== undefined).filter(t => t.flags.dnd5e.origin === item.uuid);\nlet template = templates[0];\n\nlet target = null;\n\n// check if the \"aura\" is up (if there is the MeasuringTemplate with our flag)\nif (typeof template !== \"undefined\") {\n\n    if (useMouseHover) {\n        // check for hovered and try to heal if valid\n        target = canvas.tokens.hover;\n        if (canvas.tokens.hover === null) {\n            ui.notifications.warn(`${macroLabel}, Actor hovered ${actor?.name} invalid target (no Actor found).`);\n            return;\n        }\n    } else {\n        target = game.user.targets.first();\n    }\n\n    // check range and abort if to far, for corner-cases roll in dice tray or temporarily move one of the tokens.\n    const tokenSource = token;\n    const tokenTarget = target;\n\n    if (checkRange) {\n        const distance = Math.round(canvas.grid.measureDistance(tokenSource, tokenTarget, { gridSpaces: true }));\n        const distance3D = Math.round(Math.sqrt(distance * distance + (tokenSource.document.elevation - tokenTarget.document.elevation) * (tokenSource.document.elevation - tokenTarget.document.elevation)));\n\n        if ((useDistance3D ? distance3D : distance) > 30) {\n            ui.notifications.warn(\n                `Distance between ${token.actor.name} and ${target.actor.name} is ${(useDistance3D ? distance3D : distance)}. Expected distance<=30.`,\n                { permanent: true }\n            );\n\n            return;\n        }\n    }\n\n    const effect = actor.effects.find(e => e.flags?.world?.origin === item.uuid);\n    const spellLevel = effect.flags.world.spellLevel;\n\n    const isDiscipleOfLife = actor.classes?.cleric?.subclass?.identifier === \"life-domain\";\n    let bonusHealing = 0;\n    if (isDiscipleOfLife) {\n        bonusHealing += spellLevel + 2;\n    }\n\n    const bonusHealingString = bonusHealing !== 0 ? `+${bonusHealing}` : \"\";\n\n    const dice = target.actor.items.filter(i => i.name === (\"Eldritch Invocations: Gift of the Ever-Living Ones\")).length > 0 ? \"12\" : \"2d6\";\n    const roll = await new Roll(`${dice}${bonusHealing !== 0 ? bonusHealingString : \"\"}`, actor.getRollData()).evaluate({ async: true });\n    const hpHealed = roll.total;\n    roll.toMessage({\n        speaker: ChatMessage.getSpeaker({ actor: token.actor }),\n        flavor: `${macroLabel}, healing ${target.name} for ${hpHealed}hp.`\n    });\n    const requestorData = [{ uuid: target.document.uuid, healing: hpHealed }];\n\n    // request healing\n    await Requestor.request({\n        title: `${macroLabel}`,\n        description: `healing ${target.name} for ${hpHealed}hp, ${effect.flags.world.charges} charges left.`,\n        img: icon,\n        whisper: [game.users.getName(\"Gamemaster\").id],\n        buttonData: [{\n            label: `${target.name.substr(0, 6)} +${hpHealed}[heal], ${effect.flags.world.charges} charges`,\n            limit: Requestor.LIMIT.ONCE,\n            permission: Requestor.PERMISSION.GM,\n            action: async () => {\n                for (let i = 0; i < this.requestorData.length; i++) {\n                    await canvas.tokens.placeables.find(t => t.document.uuid === this.requestorData[i].uuid).actor.applyDamage(-this.requestorData[i].healing)\n                }\n            },\n            requestorData: requestorData // what is here gets into this.<something>\n        }]\n    });\n\n\n    const charges = 10;\n    const effectData = { icon, label: `${macroLabel} (${charges})` };\n    foundry.utils.setProperty(effectData, \"flags.world.spellLevel\", spellLevel);\n    foundry.utils.setProperty(effectData, \"flags.world.charges\", 10);\n    foundry.utils.setProperty(effectData, \"flags.world.origin\", item.uuid);\n\n    await effect.update({\n        label: `${macroLabel} (${effect.flags.world.charges - 1})`,\n        \"flags.world.charges\": effect.flags.world.charges - 1\n    });\n\n    return;\n}\n\n// use the item (takes care of resources, ChatMessage), if returning null (i believe) return\nconst use = await item.use();\nif (!use) {\n    return;\n}\n\nconst DIV = document.createElement(\"DIV\");\nDIV.innerHTML = use.content;\nconst spellLevel = Number(DIV.firstChild.dataset.spellLevel);\n\n\n// select the MeasuringTemplate created by the Item.Spell use() and modify\ntemplate = canvas.scene.templates.filter(t => t.flags.dnd5e !== undefined).filter(t => t.flags.dnd5e.origin === item.uuid)[0];\n\nconst templateData = {\n    borderColor: \"#00800f\",\n    fillColor: \"#022400\",\n    x: token.center.x,\n    y: token.center.y\n};\nawait template.update(templateData);\nawait tokenAttacher.attachElementsToToken([template], token);\n\nconst charges = 10;\nconst effectData = { icon, label: `${macroLabel} (${charges})` };\nfoundry.utils.setProperty(effectData, \"flags.world.spellLevel\", spellLevel);\nfoundry.utils.setProperty(effectData, \"flags.world.charges\", 10);\nfoundry.utils.setProperty(effectData, \"flags.world.origin\", item.uuid);\nawait actor.createEmbeddedDocuments(\"ActiveEffect\", [effectData]);","author":"YCF2Heb7DMHDaF2f","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.QLc7cJv6mcLw7ixj.Item.Rqf1728uAtt9fglH"}},"img":"icons/magic/life/cross-area-circle-green-white.webp","effects":[{"label":"Aura of Vitality","icon":"icons/magic/life/cross-area-circle-green-white.webp","origin":"Actor.QLc7cJv6mcLw7ixj.Item.Rqf1728uAtt9fglH","duration":{"seconds":60,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"DudGC8XWDVNDAwkk","changes":[],"tint":null,"transfer":false,"flags":{}}],"ownership":{"default":0,"YCF2Heb7DMHDaF2f":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.4","coreVersion":"10.291","createdTime":1676130280082,"modifiedTime":1676871652879,"lastModifiedBy":"YCF2Heb7DMHDaF2f"},"folder":null,"sort":0,"_id":"o765P2hrQacbcTvT"}
