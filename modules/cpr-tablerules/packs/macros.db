{"name":"WeaponDamageMinus","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"systems/cyberpunk-red-core/icons/dice/black/d6_6.svg","command":"actor = canvas.tokens.controlled[0]?.actor;\nif (actor === undefined) {\n    ui.notifications.warn(\"Select exactly one Actor\");\n    return;\n}\n\nweapons = actor.items.filter(i => i.system.equipped === \"equipped\" && i.type === \"weapon\");\n\nif (weapons.length !== 1) {\n    ui.notifications.warn(\"Exactly one weapon needs to be equiped for this to work.\");\n    return;\n} else {\n    weapon = weapons[0];\n}\n\ndamage = weapon.system.damage;\nnumberOfDice = Number(damage.substr(0, damage.length - 2));\n\nui.notifications.info(`Setting damage of ${actor.name}'s ${weapon.name} to ${numberOfDice - 1}d6`);\n\nawait weapon.update({ \"system.damage\": `${numberOfDice - 1}d6` });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.FOMCSYLUghMaAc34"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.303","createdTime":1688348696288,"modifiedTime":1688409936928,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"3mCOABPZlHGHh4R8"}
{"name":"Scale Up","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"modules/Tablerules/icons/gui/ScaleUp.png","command":"const scalingPercent = 5 / 100;\ntoken = canvas.tokens.controlled[0];\nawait token.document.update({ \"texture.scaleX\": token.document.texture.scaleX * (1 + scalingPercent), \"texture.scaleY\": token.document.texture.scaleY * (1 + scalingPercent) });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.0w3oA4BlomjWiOR2"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681622441998,"modifiedTime":1681622480746,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"44H8y5fMNTebuV0d"}
{"name":"Skills Sum","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"icons/svg/dice-target.svg","command":"const buttons = {\n    heal: {\n        icon: \"<i class='fa-solid fa-hand-holding-heart'></i>\",\n        label: \"OK\",\n        callback: async (html) => {\n        }\n    }\n}\n\nnew Dialog({ title: \"Skill Sum\", content: `${canvas.tokens.controlled[0].actor.items.filter(i => i.type === \"skill\").filter(i => i.system.core === true).reduce((acc, i) => { return acc + ((i.system.difficulty === \"dificult\") ? i.system.level * 2 : i.system.level) }, 0)}`, buttons }).render(true);","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.dQu7cTb9KkYkm569"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681622314369,"modifiedTime":1681622324505,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"5xBVpgiGZLdgOfOP"}
{"name":"Dim Down","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"modules/Tablerules/icons/gui/ScaleDown.png","command":"await token.document.update({ height: token.document.height / 2, width: token.document.width / 2 })","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.T1SVHlGb9H4POGI2"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681622524211,"modifiedTime":1681622551819,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"B02B6k0Dzoe9NQ6N"}
{"name":"Cyberware - Plus Damage (Template)","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"systems/cyberpunk-red-core/icons/dice/black/d6_6.svg","command":"actor = canvas.tokens.controlled[0]?.actor;\nif (actor === undefined) {\n    ui.notifications.warn(\"Select exactly one Actor\");\n    return;\n}\n\n//Change the (i=> i._id ===\"\"); to the Id of the item you need to modify\nweapons = actor.items.filter(i => i._id === \"IZUsJJq5JGrZ8yUD\");\n\nif (weapons.length !== 1) {\n    ui.notifications.warn(\"Exactly one weapon needs to be equiped for this to work.\");\n    return;\n} else {\n    weapon = weapons[0];\n}\n\ndamage = weapon.system.damage;\nnumberOfDice = Number(damage.substr(0, damage.length - 2));\n\nui.notifications.info(`Setting damage of ${actor.name}'s ${weapon.name} to ${numberOfDice + 1}d6`);\n\nawait weapon.update({ \"system.damage\": `${numberOfDice + 1}d6` });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.f9UJmg8aBM02YrAa"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.303","createdTime":1688408578983,"modifiedTime":1688409655892,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"GHgazH0oHMMjfjSR"}
{"name":"Cyberweapon - Minus Damage (Template)","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"systems/cyberpunk-red-core/icons/dice/black/d6_6.svg","command":"actor = canvas.tokens.controlled[0]?.actor;\nif (actor === undefined) {\n    ui.notifications.warn(\"Select exactly one Actor\");\n    return;\n}\n\n\n//Change the (i=> i._id ===\"\"); to the Id of the item you need to modify\nweapons = actor.items.filter(i => i._id === \"IZUsJJq5JGrZ8yUD\");\n\nif (weapons.length !== 1) {\n    ui.notifications.warn(\"Exactly one weapon needs to be equiped for this to work.\");\n    return;\n} else {\n    weapon = weapons[0];\n}\n\ndamage = weapon.system.damage;\nnumberOfDice = Number(damage.substr(0, damage.length - 2));\n\nui.notifications.info(`Setting damage of ${actor.name}'s ${weapon.name} to ${numberOfDice - 1}d6`);\n\nawait weapon.update({ \"system.damage\": `${numberOfDice - 1}d6` });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.OlyqoOA6KiSJ3A9X"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.303","createdTime":1688409170439,"modifiedTime":1688409654376,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"I6s3NfABiNiCERCD"}
{"name":"Cycle Wildcard Token","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"icons/svg/dice-target.svg","command":"// https://github.com/krbz999/zhell-macros/blob/main/tools/token/cycle_token_wildcards.js\nconst currentImg = token.document.texture.src;\nconst actorId = token.actor.id;\nconst wildcardImages = await game.actors.get(actorId).getTokenImages();\nconst currentIndex = wildcardImages.indexOf(currentImg);\nconst next = (currentIndex + 1) === wildcardImages.length ? 0 : currentIndex + 1;\nawait token.document.update({ \"texture.src\": wildcardImages[next] });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.8x36wGygfdANvyBZ"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681621349567,"modifiedTime":1681621368284,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"IY10V44ySzdZ0DwC"}
{"name":"WeaponDamagePlus","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"systems/cyberpunk-red-core/icons/dice/black/d6_6.svg","command":"actor = canvas.tokens.controlled[0]?.actor;\nif (actor === undefined) {\n    ui.notifications.warn(\"Select exactly one Actor\");\n    return;\n}\n\nweapons = actor.items.filter(i => i.system.equipped === \"equipped\" && i.type === \"weapon\");\n\nif (weapons.length !== 1) {\n    ui.notifications.warn(\"Exactly one weapon needs to be equiped for this to work.\");\n    return;\n} else {\n    weapon = weapons[0];\n}\n\ndamage = weapon.system.damage;\nnumberOfDice = Number(damage.substr(0, damage.length - 2));\n\nui.notifications.info(`Setting damage of ${actor.name}'s ${weapon.name} to ${numberOfDice + 1}d6`);\n\nawait weapon.update({ \"system.damage\": `${numberOfDice + 1}d6` });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.gW31V3hnJcGMKk79"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.303","createdTime":1688348624763,"modifiedTime":1688409938449,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"Y9ZC4RUWjNaVTmjx"}
{"name":"Rotate +1","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"modules/Tablerules/icons/gui/rotateCW_white.png","command":"token.document.update({ rotation: token.document.rotation + 1 });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.KacjAO4ZBWL4wLqA"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681621841627,"modifiedTime":1682886727548,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"kUY3ZYtj1fSycU5U"}
{"name":"Cycle Wildcard Token -1","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"icons/svg/dice-target.svg","command":"// https://github.com/krbz999/zhell-macros/blob/main/tools/token/cycle_token_wildcards.js\nconst currentImg = token.document.texture.src;\nconst actorId = token.actor.id;\nconst wildcardImages = await game.actors.get(actorId).getTokenImages();\nconst currentIndex = wildcardImages.indexOf(currentImg);\nconst next = (currentIndex - 1) >= 0 ? (currentIndex - 1) : wildcardImages.length - 1;\n\nawait token.document.update({ \"texture.src\": wildcardImages[next] });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.6vsxMAGCxuHdocaq"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681621375536,"modifiedTime":1681621389725,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"pF2mBolEoxbWyUU0"}
{"name":"Scale Down","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"modules/Tablerules/icons/gui/ScaleDown.png","command":"const scalingPercent = -(5 / 100);\ntoken = canvas.tokens.controlled[0];\nawait token.document.update({ \"texture.scaleX\": token.document.texture.scaleX * (1 + scalingPercent), \"texture.scaleY\": token.document.texture.scaleY * (1 + scalingPercent) });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.cKC70UQ9XOw3OsJQ"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681622411466,"modifiedTime":1681622493386,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"wgmQgiDTkX8KzhpU"}
{"name":"List Modules","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"icons/svg/dice-target.svg","command":"// the console report can be copied directly into the Markdown documentation (right-click copy String contents)\n\nconst modulesActive = game.modules.filter(m => m.active);\nconst moduleReport = modulesActive.map(\n    m => ({ id: m.id, title: m.title, version: m.version })\n);\nconsole.log(modulesActive);\nconsole.log(moduleReport);\n\nlet reportString = \"\";\n\nfor (i = 0; i < modulesActive.length; i++) {\n    m = modulesActive[i];\n    reportString = `${reportString}\\n1. ${m.title} (version: ${m.version}) : [Project-URL](${m.url})`;\n}\n\nconsole.log({ reportString: reportString });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.92QULNlo8yvQ7U40"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681621121983,"modifiedTime":1681621162979,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"xBbTSYESfNmgIbLa"}
{"name":"Dim Up","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"modules/Tablerules/icons/gui/ScaleUp.png","command":"await token.document.update({ height: token.document.height * 2, width: token.document.width * 2 })","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.UbybPef5pSDiqtVI"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681622572502,"modifiedTime":1681622595683,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"yn2VeXQupwFNT11n"}
{"name":"Stats Sum","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"icons/svg/dice-target.svg","command":"const buttons = {\n    heal: {\n        icon: \"<i class='fa-solid fa-hand-holding-heart'></i>\",\n        label: \"OK\",\n        callback: async (html) => {\n        }\n    }\n}\n\nconst sum =\n    canvas.tokens.controlled[0].actor.system.stats.body.value +\n    canvas.tokens.controlled[0].actor.system.stats.cool.value +\n    canvas.tokens.controlled[0].actor.system.stats.dex.value +\n    canvas.tokens.controlled[0].actor.system.stats.emp.max +\n    canvas.tokens.controlled[0].actor.system.stats.int.value +\n    canvas.tokens.controlled[0].actor.system.stats.luck.max +\n    canvas.tokens.controlled[0].actor.system.stats.move.value +\n    canvas.tokens.controlled[0].actor.system.stats.ref.value +\n    canvas.tokens.controlled[0].actor.system.stats.tech.value +\n    canvas.tokens.controlled[0].actor.system.stats.will.value;\n\nnew Dialog({ title: \"Stats Sum\", content: `${sum}`, buttons }).render(true);","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.RDt3ESPcWtgS8tC4"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681622333465,"modifiedTime":1681622342161,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"z3WpmCkH6e5urIJo"}
{"name":"Rotate -1","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"modules/Tablerules/icons/gui/rotateCCW_white.png","command":"token.document.update({ rotation: token.document.rotation - 1 });","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.KacjAO4ZBWL4wLqA"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.86.1","coreVersion":"10.291","createdTime":1681621841627,"modifiedTime":1681622142665,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"zKRvBYy6g09owgYz"}
{"name":"Grenade Random","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"systems/cyberpunk-red-core/icons/compendium/ammo/grenade_teargas.png","command":"const original = canvas.scene.templates.contents.at(-1);\nconst range = original.distance;\n\nMath.radians = function (degrees) {\n    return degrees * Math.PI / 180;\n};\n\nfunction move(point, angle, unit) {\n    const rad = Math.radians(angle % 360);\n\n    let [x, y] = point;\n    x += unit * Math.sin(rad);\n    y -= unit * Math.cos(rad);\n\n    return [x, y];\n}\n\nconst randomDirection = Math.random() * 360;\nconst randomDistance = Math.random() * range;\nconst coordinatesOriginal = [original.x, original.y];\nconst coordinatesRandomWalked = move(coordinatesOriginal, randomDirection, randomDistance * canvas.scene.grid.size);\n\nif (coordinatesRandomWalked[0] <= 0 || coordinatesRandomWalked[0] >= canvas.scene.dimensions.width || coordinatesRandomWalked[1] <= 0 || coordinatesRandomWalked[1] >= canvas.scene.dimensions.height) {\n    ui.notifications.warn(`RandomWalk left the scene: ${coordinatesRandomWalked}`);\n    return;\n}\n\nconst randomWalked = original.toObject();\nrandomWalked.x = coordinatesRandomWalked[0];\nrandomWalked.y = coordinatesRandomWalked[1];\n\nawait canvas.scene.createEmbeddedDocuments(\"MeasuredTemplate\", [randomWalked]);","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.5b69qqIq0cvnfd9p"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.87.3","coreVersion":"10.303","createdTime":1690125768233,"modifiedTime":1690128331932,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"Z0y3Itz5oVJ6npgd"}
{"name":"Volume Save","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"icons/magic/sonic/bell-alarm-red-purple.webp","command":"ui.notifications.info(`Saving volumes: globalPlaylistVolume=${game.settings.get('core', 'globalPlaylistVolume')}, globalAmbientVolume=${game.settings.get('core', 'globalAmbientVolume')}, globalInterfaceVolume=${game.settings.get('core', 'globalInterfaceVolume')}`, { permanent: true });\nui.notifications.info(\"Volume values are on a logarithmic scale within a range of 0-1. Don't be alarmed by low values.\",\n    { permanent: true })\n\ngame.user.update({\n    'flags.world': {\n        globalPlaylistVolume: game.settings.get('core', 'globalPlaylistVolume'),\n        globalAmbientVolume: game.settings.get('core', 'globalAmbientVolume'),\n        globalInterfaceVolume: game.settings.get('core', 'globalInterfaceVolume')\n    }\n})","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.vEsNpfLoTXkrPV5u"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.87.3","coreVersion":"10.303","createdTime":1690128336728,"modifiedTime":1690128381593,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"UdQg9CxCakp4a6Xj"}
{"name":"Timeout","type":"script","scope":"global","author":"NULqOZ3hJTnRGB81","img":"icons/magic/time/clock-stopwatch-white-blue.webp","command":"const content = `\n<form>\n    <div class=\"form-group\">\n        <label for=\"message\">Message cast:</label>\n        <div class=\"form-fields\">\n            <input id=\"message\" type=\"text\" value=\"\"></input>\n        </div>\n    </div>\n</form>`;\n\nconst buttons = {\n    message: {\n        icon: \"<i class='fa-regular fa-bell'></i>\",\n        label: \"Timeout!\",\n        callback: async (html) => {\n            const message = html[0].querySelector(\"#message\").value;\n            return await ChatMessage.create({\n                content: `\n                <div style=\"width:100%;\">\n                    <img style=\"padding:5px; background-color: red;\" src=\"icons/magic/time/clock-stopwatch-white-blue.webp\"><b>Timeout?!</b><br/>\n                    ${message}\n                </di>\n                `,\n                sound: \"modules/Tablerules/sounds/turn.ogg\",\n                whisper: ChatMessage.getWhisperRecipients('GM')\n            });\n        }\n    }\n}\n\nnew Dialog({ title: \"Timeout\", content, buttons, default: \"message\" }).render(true);","ownership":{"default":0,"NULqOZ3hJTnRGB81":3},"flags":{"core":{"sourceId":"Macro.rzfvM5n57lMCrnsk"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.87.3","coreVersion":"10.303","createdTime":1690128390813,"modifiedTime":1690128420886,"lastModifiedBy":"NULqOZ3hJTnRGB81"},"folder":null,"sort":0,"_id":"rowF7BreAVTR4RgJ"}
